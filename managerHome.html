<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Manager Homepage</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://kit.fontawesome.com/b1b6f02eef.js" crossorigin="anonymous"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-database.js"></script>


<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-black w3-card">
    <a class="w3-bar-item w3-button w3-padding-large w3-hide-medium w3-hide-large w3-right" href="javascript:void(0)"><i class="fa fa-bars"></i></a>
    <a href="#home" class="w3-bar-item w3-button w3-padding-large"><span style="color: rgb(247, 244, 243);">
      <i class="fas fa-cat" onclick="home()" id="home"></i>
      </span></a>
    <a href="#analytics" class="w3-bar-item w3-button w3-padding-large" onclick ="analytics()">Analytics</a> 
    <a href="#schedule" class="w3-bar-item w3-button w3-padding-large" onclick ="schedule()">Schedule</a>
    <a href="#employees" class="w3-bar-item w3-button w3-padding-large w3-hide-small" onclick ="employees()">Employees</a>
    
    <a href="javascript:void(0)" class="w3-padding-large w3-hover-white w3-hide-small w3-right"><i class="far fa-bell"></i></a>
    <a href="javascript:void(0)" class="w3-padding-large w3-hover-white w3-hide-small w3-right"><i class="far fa-comments"></i></a>
    <div class="w3-dropdown-hover w3-hide-small w3-right">
      <button class="w3-padding-large w3-button" title="account"><span style="color: rgb(247, 244, 243);"><i class="fas fa-user-astronaut"></i></span></button>     
      <div class="w3-dropdown-content w3-bar-block w3-card-4">
        <a href="#account" class="w3-padding-large w3-bar-item w3-button" onclick="accnt()">Account</a>
        <a href="#logout" class="w3-padding-large w3-bar-item w3-button" onclick="logout()">Log Out</a>
      </div>
    </div>
  </div>
</div>

<div class="w3-modal" id="logoutform" style="display:none">
  <form class="w3-modal-content">
    <h1>Are you sure you want to log out?</h1>

    <button class="w3-button w3-black" onclick="confirmLogOut()">Log Out</button>
    <button class="w3-button w3-black" onclick="closeForm()">Close</button>
  </form>
</div>

<div class = "w3-container w3-center">
  <br><br>
<h1>Welcome Home Manager :)</h1>
<h2><b>Schedule</b></h2>
<br><br><br><br>
</div>
<div class="w3-container w3-center" style="margin:auto; width:850px ">
  <h2><b>Messages</b></h2>
  <div class="w3-row">
      <div class="w3-card w3-white ">
        <div class="w3-panel w3-border">
          <h3><b>TO MY PRECIOUS COLLEAGUES</b></h3>
        <div id="result">
        </div>
        </div>
        <div class="w3-container w3-border w3-padding-large">
          <textarea id="sender" placeholder="enter your name" rows="1" style="width:80%;"></textarea>
          <br><br>
          <textarea id="msg" placeholder="write your message here" rows="10" style="width:80%;"></textarea><br>
          <button class="w3-button w3-center w3-padding-large w3-white w3-border" id="post"><b>POST</b></button>
         
      </div>
    </div>
  </div>
</div>


 
<script>

var firebaseConfig = {
        apiKey: "AIzaSyCMkSmHmn_zNCoHwthP9J6HtqPgtwokXyo",
        authDomain: "capstone450.firebaseapp.com",
        databaseURL: "https://capstone450-default-rtdb.firebaseio.com",
        projectId: "capstone450",
        storageBucket: "capstone450.appspot.com",
        messagingSenderId: "706717697173",
        appId: "1:706717697173:web:00b44ba17bb2fa112bc79c",
        measurementId: "G-V28RYN23J2"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

var uid = location.search.substring(1);

function home() {
window.location.href = "managerHome.html"
}

function accnt() {
  window.location.href = "managerAccount.html?" + uid + ""
}

function analytics(){
    window.location.href="analytics.html";
}

function schedule(){
    window.location.href="managerSchedule.html";
}

function logout(){
  document.getElementById("logoutform").style.display = "block";
}

function confirmLogOut(){
  firebase.auth().signOut().then(() => {
    window.location.href = "/index.html"
  }).catch((error) => {
    alert("error")
  });
}


var sender=document.getElementById("sender");
var msg=document.getElementById("msg");

document.getElementById("post").addEventListener("click", function(e){
  if(sender.value==""||msg.value==""){
    alert("Fill in all fields.");
  }
  else{
  firebase.database().ref("MsgPosts").push({
    sender: sender.value,
    text: msg.value,

  });
  msg.value='';
  }
});

var post=document.getElementById("result");
firebase.database().ref("MsgPosts").on("value", function(snapshot){
  post.innerHTML='';
  snapshot.forEach(function(e){
    var x=e.val();
    post.innerHTML+= x.sender + ":" + x.text + 
    "<hr>";

  });
});

</script>


</body>
</html>
